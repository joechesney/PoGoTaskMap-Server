<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script src="node_modules/jquery/dist/jquery.min.js"></script>

</head>
<body>
  <div class="centered">
    <p>This site is still under construction.</p>
    <div id="how-to-use-list" class="centered">
      <label for="how-to-use"><h2>How to use this site:</h2></label>
      <ol name="how-to-use">
        <li>To submit a Research Task, click that pokestop's pin, enter the task requirements and reward(s), then hit enter. The page will reload to show you the task was submitted.</li>
        <li>To submit a new pokestop, just click on the map. The longitude and latitude of where you clicked will be entered into the inputs at the bottom of the screen. Then just enter the pokestop's name, and hit submit. The page will be reloaded to show you the new pokestop!</li>
      </ol>
    </div>

    <p>To request changes, please fill out this form</p>
    <form>
      <input id="user-email" type="email" placeholder="email" required/><br>
      <textarea id="changes-requested" rows="4" cols="25" type="text" placeholder="changes requested" required ></textarea><br>
      <input id="submit-change-request" type="button" value="submit" >
    </form>
    <br>
    <hr>
    <br>
    <a href="./index.html">Go back to map</a>
  </div>
  <style>
    .centered {
      margin: 0 auto;
      text-align: center;
    }
    #how-to-use-list {
      width:70%;
    }
    input, textarea {
      border: solid black 1px;
    }
  </style>
  <script>
    function sendChangeRequestEmail(changeRequestObject) {
      return new Promise((resolve, reject) => {
        $.ajax({
          url: `http://localhost:8080/changeRequest`,
          method: 'POST',
          xhrFields: {
            withCredentials: false
          },
          data: changeRequestObject,
          success: function (data) {
            console.log('Success', data);
            resolve(data);
          },
          error: function (err) {
            console.log(err);
            reject(err);
          }
        });
      });
    }
    $("#submit-change-request").on("click", function() {
      let changeRequestObject = {
        userEmail: $("#user-email").val(),
        changesRequested: $("#changes-requested").val()
      }
      sendChangeRequestEmail(changeRequestObject)
      .then(response =>{
        console.log('response: ',response);
      })

    });
  </script>
</body>
</html>